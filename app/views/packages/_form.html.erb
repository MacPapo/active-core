<%= form_with model: package, local: true do |form| %>
    <% if package.errors.any? %>
        <div>
            <% package.errors.full_messages.each do |message| %>
                <p><%= message %></p>
            <% end %>
        </div>
    <% end %>

    <div>
        <%= form.label :name %>
        <%= form.text_field :name %>
    </div>

    <div>
        <%= form.label :description %>
        <%= form.text_area :description %>
    </div>

    <div>
        <%= form.label :price %>
        <%= form.number_field :price, step: 0.01 %>
    </div>

    <div>
        <%= form.label :affiliated_price %>
        <%= form.number_field :affiliated_price, step: 0.01 %>
    </div>

    <div>
        <%= form.label :duration_type %>
        <%= form.select :duration_type, [["Giorni", "days"], ["Mesi", "months"], ["Anni", "years"]] %>
    </div>

    <div>
        <%= form.label :duration_value %>
        <%= form.number_field :duration_value %>
    </div>

    <div>
        <%= form.label :valid_from %>
        <%= form.date_field :valid_from %>
    </div>

    <div>
        <%= form.label :valid_until %>
        <%= form.date_field :valid_until %>
    </div>

    <div>
        <%= form.label :max_sales %>
        <%= form.number_field :max_sales %>
    </div>

    <div>
        <%= form.check_box :active %>
        <%= form.label :active, "Attivo" %>
    </div>

    <h3>Prodotti Inclusi</h3>
    <div id="package-inclusions">
        <%= form.fields_for :package_inclusions do |inclusion_form| %>
            <%= render "package_inclusion_fields", form: inclusion_form %>
        <% end %>
    </div>

    <button type="button" onclick="addInclusion()">Aggiungi Prodotto</button>

    <%= form.submit %>
<% end %>

<script>
 function addInclusion() {
     // Simple JS to add new inclusion fields - basic implementation
     const container = document.getElementById('package-inclusions');
     const template = container.children[0].cloneNode(true);
     const inputs = template.querySelectorAll('input, select');
     inputs.forEach(input => input.value = '');
     container.appendChild(template);
 }
</script>
