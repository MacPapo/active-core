<h1>Nuovo Utente Staff</h1>

<%= form_with model: @user, local: true do |form| %>
    <% if @user.errors.any? %>
        <div class="error-messages">
            <h2><%= pluralize(@user.errors.count, "errore") %> ha impedito il salvataggio:</h2>
            <ul>
                <% @user.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                <% end %>
            </ul>
        </div>
    <% end %>

    <div class="field">
        <%= form.label :member_id, "Membro:" %>
        <%= form.select :member_id,
            options_from_collection_for_select(@available_members, :id, :full_name, @user.member_id),
         { prompt: "Seleziona un membro..." },
         { required: true } %>
        <small>Solo i membri senza account utente sono disponibili</small>
    </div>

    <div class="field">
        <%= form.label :nickname, "Nickname:" %>
        <%= form.text_field :nickname, required: true, placeholder: "es. mario.rossi" %>
        <small>Sar√† utilizzato per il login</small>
    </div>

    <div class="field">
        <%= form.label :role, "Ruolo:" %>
        <%= form.select :role,
            options_for_select([
                ['Collaboratore', 'collaborator'],
                ['Amministratore', 'admin']
            ], @user.role),
         {},
         { required: true } %>
    </div>

    <div class="field">
        <%= form.label :password, "Password:" %>
        <%= form.password_field :password, required: true %>
        <small>Minimo 6 caratteri</small>
    </div>

    <div class="field">
        <%= form.label :password_confirmation, "Conferma Password:" %>
        <%= form.password_field :password_confirmation, required: true %>
    </div>

    <div class="actions">
        <%= form.submit "Crea Utente" %>
        <%= link_to "Annulla", users_path %>
    </div>
<% end %>
