<div class="d-flex align-items-center mb-3">
  <h1 class="me-2"><%= t '.title' %></h1>
  <span>(<%= t('.registered', count: @pagy.count) %>)</span>
</div>

<div id="subscriptions">
    <table class="table table-hover">
        <thead class="table-light">
            <tr>
                <th><%= t 'global.table.id' %></th>
                <th><%= t 'global.table.updated_at' %></th>
                <th><%= t 'global.table.name' %></th>
                <th><%= t 'global.table.surname' %></th>
                <th><%= t 'global.table.activity' %></th>
                <th><%= t 'global.table.open' %></th>
                <th><%= t 'global.table.plan' %></th>
                <th><%= t 'global.table.start_date' %></th>
		<th><%= t 'global.table.end_date' %></th>
                <th><%= t 'global.table.action' %></th>
            </tr>
        </thead>

        <tbody class="table-group-divider">

            <% @subscriptions.each do |subscription| %>

                <tr>

                    <!-- ID -->
                    <th scope="row">
                        <%= subscription.id %>
                    </th>

                    <!-- Updated At -->
                    <td>
                        <%= subscription.updated_at %>
                    </td>

                    <!-- Name -->
                    <% user = subscription.user %>
                    <td>
                        <%= user.name %>
                    </td>

                    <!-- Surname -->
                    <td>
                        <%= user.surname %>
                    </td>

                    <!-- Activity -->
                    <% activity = subscription.activity %>
                    <% plan = subscription.activity_plan %>
                    <td>
                        <%= activity.name %>
                    </td>

                    <!-- OPEN -->
                    <td>
                        <%= subscription.open? %>
                    </td>

                    <!-- ActivityPlan -->
                    <td>
                        <%= plan.humanize_plan %>
                    </td>

                    <!-- Duration -->
                    <td>
                        <%= subscription.start_date %>
                    </td>

		    <td>
		      <%= subscription.end_date %>
		    </td>		    

                    <!-- Action -->
                    <td>
                        <%= link_to subscription, class: 'btn btn-primary' do %>
                            <i class="bi bi-eye-fill"></i>
                        <% end %>

                        <%= link_to edit_subscription_path(subscription), class: 'btn btn-warning' do %>
                            <i class="bi bi-pencil-fill"></i>
                        <% end %>

                        <% if current_staff.admin? %>
                            <%= button_to subscription,
                                          class: 'btn btn-danger',
                                          method: :delete,
                                          data: { turbo_confirm: "Sicuro di voler eliminare questo utente? L'operazione non Ã¨ reversibile" },
                                          form: {style: 'display:inline-block;'} do %>
                                <i class="bi bi-trash3-fill"></i>
                            <% end %>
                        <% end %>
                    </td>
                </tr>
            <% end %>
        </tbody>

    </table>
    <%== pagy_bootstrap_nav(@pagy) %>
</div>
